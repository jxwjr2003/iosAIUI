# 实现 iOS UI 编辑器

## Why
当前需要创建一个可视化的 iOS UI 层级编辑器，通过三面板界面让用户能够直观地构建、编辑和管理复杂的 UI 组件层级关系。该工具将支持约束配置、实时预览，并能根据编辑后的树形结构输出指定的 UI 层级描述。

## What Changes
- **新增四区域编辑器界面**：左侧树形结构（35%）、中间模拟器预览（30%）、右侧属性编辑（35%）、底部 AI 聊天区域
- **实现 UI 树形编辑器**：
  - 默认展开所有节点及子节点，平铺展示完整层级结构
  - 每个节点提供操作按钮：添加子节点、删除节点、复制节点（包含所有子节点）、粘贴子节点
  - 添加子节点时弹出组件类型选择对话框，支持多种 iOS 组件类型选择
  - 支持节点拖拽排序和层级调整
  - 自动生成和维护层级节点 ID（030201 格式）
  - 点击节点时属性编辑器实时同步显示节点信息
- **开发 iOS 模拟器**：实时渲染选中的根节点（基于 CSS 的 Web 模拟，仅静态预览），支持完整的约束布局计算，根节点宽度默认与模拟器一致，高度自适应，提供手动刷新按钮，支持子节点修改时的根节点溯源展示
- **创建属性编辑器**：
  - **基础信息**：节点ID自动展示（只读），节点名称可编辑，节点类型选择（支持30+种UIKit组件类型）
  - **根节点类型同步**：所有根节点都是UI组件库，根节点名称修改后自动同步到节点类型选择器
  - **Attributes属性管理**：
    - 颜色属性支持16进制和RGB格式输入，带实时颜色预览
    - 默认attributes为空，提供新增按钮，根据节点类型显示常见属性
    - 支持自定义属性，需要用户输入key、value、type
    - 属性key不能重复
  - **约束包管理**：
    - 默认约束包为空，第一个创建的约束包为默认约束包
    - 支持添加、命名、删除约束包
    - 约束配置：选择约束类型（size、edge等）、方法、数值、参考节点（仅父节点和兄弟节点）
    - 系统整体判断约束冲突
  - **成员变量管理**：支持新增、编辑、删除成员变量，手动输入变量名称、类型、默认值
  - **函数和协议管理**：
    - functions/eventFunctions格式：funcName、funcLogic字段
    - protocols格式：protocolName、protocolLogic字段
    - 支持新增、编辑、删除
  - **布局选择**：子节点布局选择器（horizontal/vertical），默认horizontal，仅当有子节点时生效
  - **备注字段**：description字段，多行文本输入框，用于节点说明
- **添加数据管理功能**：JSON 导入导出（支持选择性展示根节点），UI 层级转文本描述，数据持久化和版本兼容性
- **集成 AI 聊天助手**：
  - 底部三栏布局：聊天历史（55%）、配置和上下文面板（25%）、修改日志面板（20%）
  - 实时显示当前选中节点信息（节点ID和名称），自动传递给AI作为上下文
  - 支持命令逐一确认执行：AI返回修改命令时弹出确认对话框，用户可逐一确认或批量执行
  - 提供完整的修改日志系统：记录所有AI修改的历史，支持搜索、筛选和导出
  - 通过 Electron 主进程连接 AI 服务器，提供智能建议和 JSON 结构优化
  - 支持 JSON 规范描述和命令格式定义，提供完整的 AI 配置系统（API Key、模型选择）
- **专注于 JSON 数据结构输出**：系统专注于 UI 层级结构的可视化编辑和标准化 JSON 输出，不涉及任何编程语言代码生成

## Impact
- **新增能力**：`ui-tree-editor`、`ios-simulator`、`property-editor`、`data-management`、`ai-chat-assistant`、`electron-main-process`、`ui-design-system`
- **技术栈**：原生 JavaScript、CSS、HTML（前端），Electron（桌面应用框架）
- **文件结构**：创建新的编辑器目录结构，基于现有 JSON 格式进行扩展
- **性能要求**：支持复杂 UI 层级树（最多1000个节点）的流畅编辑和实时预览，响应时间小于100ms
- **进程通信**：Electron 主进程与渲染进程通过 IPC 通信
- **AI 集成**：Electron 主进程直接连接第三方 AI 服务，简化架构
- **安全要求**：Electron 安全配置，API Key 使用安全存储，适合桌面应用使用
- **部署方式**：打包为可执行文件，通过 `npm start` 启动，或直接运行打包后的应用
